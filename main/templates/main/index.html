{% extends 'base.html' %}

{% block main %}

<h1 class="mt-5">Overland Connect</h1>

{% if not request.user.is_authenticated %}
<div class="row">
  <div class="col-md">
    <p>
      Connect to your <i>Open Humans</i> account to start collecting your location data with <i>Overland</i> on your iPhone.
    </p>
    <a href="{{ auth_url }}" class="btn btn-primary">
      Connect to Open Humans
    </a>
  </div>
  <div class="col-md">
    <h2>What is <i>Overland</i>?</h2>
    <a href='https://overland.p3k.app/'>Overland</a> is a <a href='https://overland.p3k.app/download'>free iOS app</a>
    that tracks your location and sends your data to a server of your choosing. It is highly configurable to allow you to
    preserve your privacy or battery life if you wish to do so!
    <h2>What does this website do?</h2>
    If you log in with your <i>Open Humans</i> account we create a server endpoint that allows you to import your <i>Overland</i> location data right into your <i>Open Humans</i> account.
    <h2>Will <i>Open Humans</i> make my location data publicly available?</h2>
    The short answer: No. The long answer: If you want to, you can make data sets publicly available on <i>Open Humans</i>, but you can always keep data private.
  </div>
</div>
{% else %}
<h2>
  You are logged in!
</h2>

<div class="row">
  <div class="col-md">
    <p>
      To push data from the <i>Overland</i> app on your phone to <i>Open Humans</i> you need to use the following URL as the <i>Receiver Endpoint</i> in the <i>Overland</i>:<br>
      <code name='overland_url'>{{ overland_endpoint }}</code>
      <button id="copy" class='btn btn-primary'>Copy URL</button>
    </p>
    <p>
      If you are on your computer right now and want to open these instructions on your iPhone you can scan the QR code
      below by just using the <i>Camera</i> app on your phone.
    </p>
    <p>
      The resulting website that will open contains all the information you will need.
    </p>
    <p>
      <div id="qrcode"></div>
      <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
      <script type="text/javascript">
        new QRCode(document.getElementById("qrcode"), "{{ overland_endpoint }}");
      </script>
    </p>
  </div>
  <div class="col-md">
    <h2>
      Setting up <i>Overland</i> on your <i>iPhone</i>
    </h2>
  </p>
    After you have copied your personal Overland endpoint URL you can enter it in your Overland app on your phone:
    <ul>
      <li>Open the <i>Overland</i></li>
      <li>Open the <i>Settings</i> menu by clicking on the bottom right button</li>
      <li>On the top click on <i>Set Receiver Endpoint URL</i></li>
      <li>Paste the URL you copied from the left</li>
      <li>Press <i>Save</i></li>
      <li>You are done now. Don't forget to turn on <i>Tracking Enabled</i></li>
    </ul>
    {% load static %}
    <img width="49%" src="{% static 'img/howto1.jpg'%}"/>
    <img width="49%" src="{% static 'img/howto2.jpg'%}"/>
  </p>
  </div>


{% endif %}

{% endblock main %}
